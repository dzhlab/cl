# Workflow: Разработка новой функции от начала до конца

Полный цикл разработки новой функции с использованием Claude Code.

## Сценарий

Добавление функции "Export to PDF" в веб-приложение.

## Шаг 1: Планирование и анализ

```
> Я хочу добавить функцию экспорта данных в PDF.
> Проанализируй текущую архитектуру и предложи план реализации.

Claude:
1. Читает существующую структуру проекта
2. Анализирует как реализован экспорт в других форматах
3. Предлагает детальный план
```

**Результат:**
- План реализации с разбивкой на задачи
- Список необходимых библиотек
- Оценка сложности

## Шаг 2: Создание ветки

```
> Создай новую git ветку feature/pdf-export

Claude выполнит:
git checkout -b feature/pdf-export
```

## Шаг 3: Установка зависимостей

```
> Установи необходимые зависимости для генерации PDF

Claude:
1. Анализирует доступные библиотеки (jsPDF, pdfmake, puppeteer)
2. Предлагает оптимальный вариант для проекта
3. Добавляет в package.json
4. Устанавливает через npm
```

```bash
npm install jspdf jspdf-autotable
```

## Шаг 4: Создание модуля экспорта

```
> Создай модуль для генерации PDF в src/utils/pdfExporter.ts
> Он должен:
> - Принимать данные таблицы
> - Форматировать их в PDF
> - Добавлять заголовок и дату
> - Поддерживать пагинацию

Claude:
1. Создает файл pdfExporter.ts
2. Реализует функцию generatePDF()
3. Добавляет типы TypeScript
4. Включает обработку ошибок
```

**Создан файл:** `src/utils/pdfExporter.ts`

## Шаг 5: Создание тестов

```
> Создай тесты для pdfExporter в tests/unit/pdfExporter.test.ts

Claude:
1. Создает test файл
2. Пишет unit тесты для всех функций
3. Добавляет моки для jsPDF
4. Тестирует edge cases
```

## Шаг 6: Интеграция в UI

```
> Добавь кнопку "Export to PDF" в компонент DataTable
> Файл: @src/components/DataTable.tsx

Claude:
1. Читает компонент DataTable
2. Добавляет кнопку с иконкой
3. Подключает обработчик клика
4. Импортирует pdfExporter
5. Добавляет loading state
```

## Шаг 7: Запуск тестов

```
> Запусти все тесты

Claude выполняет:
npm test
```

**Результат:**
- Все тесты проходят ✅
- Покрытие кода: 85%

## Шаг 8: Проверка типов и линтинг

```
> Проверь TypeScript типы и запусти линтер

Claude выполняет:
npm run type-check
npm run lint
```

**Результат:**
- Нет ошибок типизации ✅
- Все lint правила соблюдены ✅

## Шаг 9: Ручное тестирование

```
> Запусти dev сервер

Claude выполняет:
npm run dev
```

Тестируете функционал вручную:
- ✅ Кнопка отображается
- ✅ PDF генерируется
- ✅ Данные корректны
- ✅ Форматирование правильное

## Шаг 10: Документация

```
> Добавь JSDoc комментарии к функциям в pdfExporter.ts
> И обнови README с информацией о новой функции

Claude:
1. Добавляет JSDoc ко всем функциям
2. Обновляет README.md
3. Добавляет примеры использования
```

## Шаг 11: Код-ревью

```
> Сделай код-ревью всех изменений на предмет:
> - Безопасности
> - Производительности
> - Best practices
> - Доступности (a11y)

Claude анализирует и предлагает улучшения:
- Добавить aria-label к кнопке
- Оптимизировать генерацию больших PDF
- Добавить обработку больших объемов данных
```

Вносите предложенные улучшения.

## Шаг 12: Коммит изменений

```
> Покажи все изменения

Claude выполняет:
git status
git diff
```

Проверяете изменения.

```
> Закоммить с понятным сообщением в стиле conventional commits

Claude выполняет:
git add .
git commit -m "feat: add PDF export functionality

- Add pdfExporter utility module
- Integrate PDF export button in DataTable
- Add comprehensive unit tests
- Update documentation

Closes #123"
```

## Шаг 13: Запуш и создание PR

```
> Запуш ветку и создай Pull Request

Claude выполняет:
git push -u origin feature/pdf-export
gh pr create --title "feat: Add PDF export functionality" --body "..."
```

**PR создан:** #456

## Шаг 14: CI/CD проверки

GitHub Actions автоматически запускает:
- ✅ Тесты
- ✅ Линтинг
- ✅ TypeScript проверка
- ✅ Build

Все проверки проходят.

## Шаг 15: Code Review от команды

Коллега оставляет комментарии в PR.

```
> Исправь комментарии из PR #456

Claude:
1. Читает комментарии через gh CLI
2. Вносит необходимые изменения
3. Отвечает на комментарии
4. Коммитит исправления
```

## Шаг 16: Мердж и деплой

После одобрения:

```
> Смердж PR в main

Claude выполняет:
gh pr merge 456 --squash
```

CI/CD автоматически деплоит на staging.

## Итог

### Время разработки
- Без Claude Code: ~4-6 часов
- С Claude Code: ~1-2 часа

### Что сделал Claude Code
1. ✅ Проанализировал архитектуру
2. ✅ Создал план реализации
3. ✅ Написал код модуля
4. ✅ Создал тесты (85% coverage)
5. ✅ Интегрировал в UI
6. ✅ Добавил документацию
7. ✅ Провел код-ревью
8. ✅ Исправил замечания
9. ✅ Создал PR

### Что сделали вы
- Описали требования
- Проверили результат
- Одобрили изменения

---

## Советы для успешного workflow

### 1. Начинайте с понятного описания

❌ Плохо:
```
> Добавь экспорт
```

✅ Хорошо:
```
> Добавь функцию экспорта данных таблицы в PDF.
> Пользователь нажимает кнопку "Export to PDF",
> и получает файл report.pdf с текущими данными таблицы.
```

### 2. Разбивайте на шаги

Не пытайтесь сделать всё сразу. Двигайтесь пошагово:
1. Планирование
2. Создание основы
3. Тестирование
4. Интеграция
5. Документация

### 3. Проверяйте результаты

После каждого значимого шага:
```
> Запусти тесты
> Проверь TypeScript
> Покажи что изменилось
```

### 4. Используйте /compact

Если контекст заполняется:
```
/compact Сохрани реализацию PDF экспорта и тесты
```

### 5. Коммитьте часто

Не накапливайте изменения. Коммитьте после каждой завершенной части:
```
> Закоммить создание pdfExporter модуля
> [работаете дальше]
> Закоммить добавление UI кнопки
```

### 6. Документируйте по ходу

Не оставляйте документацию на потом:
```
> Добавь JSDoc к этой функции
> Обнови README с информацией о PDF экспорте
```

---

## Альтернативные сценарии

### Быстрая итерация (когда требования меняются)

```
> Изменились требования: PDF должен включать графики

Claude:
1. Читает текущую реализацию
2. Добавляет генерацию графиков
3. Обновляет тесты
4. Коммитит изменения
```

### Работа с багами в процессе

```
> Тесты падают после добавления графиков

Claude:
1. Анализирует ошибки тестов
2. Находит проблему (моки не обновлены)
3. Исправляет тесты
4. Проверяет что всё работает
```

### Оптимизация после ревью

```
> Код-ревьюер сказал что PDF генерация медленная для больших таблиц

Claude:
1. Профилирует код
2. Находит узкие места
3. Оптимизирует (пагинация, lazy loading)
4. Измеряет улучшение
5. Обновляет тесты производительности
```

---

Этот workflow можно адаптировать под любую задачу:
- Новая функция
- Исправление бага
- Рефакторинг
- Оптимизация
- Миграция
